<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI æ€§æ ¼æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-10px); }
            40%, 80% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        /* éªŒè¯ç é¡µé¢æ ·å¼ */
        .verify-page {
            text-align: center;
        }

        .verify-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .verify-title {
            color: #333;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .verify-subtitle {
            color: #666;
            font-size: 15px;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .code-input-wrapper {
            margin-bottom: 20px;
        }

        .code-input {
            width: 100%;
            padding: 18px 20px;
            font-size: 20px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 16px;
            outline: none;
            transition: border-color 0.3s;
            letter-spacing: 8px;
            text-transform: uppercase;
        }

        .code-input:focus {
            border-color: #667eea;
        }

        .code-input.error {
            border-color: #e74c3c;
            background: #fdf2f2;
        }

        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .verify-info {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-top: 25px;
            text-align: left;
        }

        .verify-info-title {
            font-size: 14px;
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .verify-info-text {
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }

        /* é¦–é¡µæ ·å¼ */
        .home-page {
            text-align: center;
            display: none;
        }

        .logo {
            font-size: 64px;
            margin-bottom: 20px;
        }

        h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 15px;
        }

        .subtitle {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .user-code-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            margin-bottom: 25px;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .feature {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            padding: 20px 15px;
            border-radius: 16px;
            text-align: center;
        }

        .feature-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .feature-text {
            font-size: 14px;
            color: #555;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            width: 100%;
            max-width: 300px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* æµ‹è¯•é¡µé¢æ ·å¼ */
        .test-page {
            display: none;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 8px;
            margin-bottom: 25px;
            overflow: hidden;
        }

        .progress {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #888;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .question {
            font-size: 20px;
            color: #333;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: center;
            min-height: 80px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 16px;
            padding: 18px 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 16px;
            color: #444;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f3ff;
        }

        .option:active {
            transform: scale(0.98);
        }

        /* ç»“æœé¡µé¢æ ·å¼ */
        .result-page {
            display: none;
            text-align: center;
        }

        .result-type {
            font-size: 56px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .result-name {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
        }

        .result-desc {
            color: #555;
            line-height: 1.8;
            margin-bottom: 25px;
            text-align: left;
            font-size: 15px;
        }

        .dimensions {
            margin-bottom: 30px;
        }

        .dimension {
            margin-bottom: 20px;
        }

        .dimension-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .dimension-left {
            color: #667eea;
        }

        .dimension-right {
            color: #764ba2;
        }

        .dimension-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 12px;
            position: relative;
            overflow: hidden;
        }

        .dimension-fill {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .traits {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .trait {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            color: #555;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .buttons .btn {
            flex: 1;
            min-width: 140px;
            padding: 15px 20px;
            font-size: 16px;
        }

        /* å·²å®Œæˆé¡µé¢ */
        .completed-page {
            display: none;
            text-align: center;
        }

        .completed-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .completed-title {
            color: #333;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .completed-text {
            color: #666;
            font-size: 15px;
            line-height: 1.6;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 480px) {
            body {
                padding: 15px;
            }

            .card {
                padding: 25px 20px;
                border-radius: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .question {
                font-size: 18px;
            }

            .result-type {
                font-size: 48px;
            }

            .features {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            .feature {
                padding: 15px 10px;
            }

            .code-input {
                font-size: 18px;
                letter-spacing: 5px;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e0e0e0;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* æŒ‰é’®åŠ è½½çŠ¶æ€ */
        .btn.loading-btn {
            position: relative;
            color: transparent;
        }

        .btn.loading-btn::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- éªŒè¯ç é¡µé¢ -->
        <div class="card verify-page" id="verifyPage">
            <div class="verify-icon">ğŸ”</div>
            <h2 class="verify-title">è¾“å…¥æµ‹è¯•éªŒè¯ç </h2>
            <p class="verify-subtitle">è¯·è¾“å…¥ä½ æ”¶åˆ°çš„ä¸“å±éªŒè¯ç <br>æ¯ä¸ªéªŒè¯ç ä»…é™ä½¿ç”¨ä¸€æ¬¡</p>
            
            <div class="code-input-wrapper">
                <input type="text" class="code-input" id="codeInput" placeholder="è¯·è¾“å…¥éªŒè¯ç " maxlength="8" autocomplete="off">
                <p class="error-message" id="errorMessage">éªŒè¯ç æ— æ•ˆæˆ–å·²è¢«ä½¿ç”¨</p>
            </div>
            
            <button class="btn" id="verifyBtn" onclick="verifyCode()">éªŒè¯å¹¶è¿›å…¥</button>
            
            <div class="verify-info">
                <div class="verify-info-title">ğŸ’¡ è¯´æ˜</div>
                <p class="verify-info-text">
                    â€¢ éªŒè¯ç ç”±æµ‹è¯•ç®¡ç†å‘˜æä¾›<br>
                    â€¢ æ¯ä¸ªéªŒè¯ç åªèƒ½ä½¿ç”¨ä¸€æ¬¡<br>
                    â€¢ å®Œæˆæµ‹è¯•åè¯·ä¿å­˜æˆ–æˆªå›¾ç»“æœ
                </p>
            </div>
        </div>

        <!-- é¦–é¡µ -->
        <div class="card home-page" id="homePage">
            <div class="logo">ğŸ§ </div>
            <h1>MBTI æ€§æ ¼æµ‹è¯•</h1>
            <div class="user-code-badge" id="userCodeBadge">éªŒè¯ç : ----</div>
            <p class="subtitle">æ¢ç´¢ä½ çš„æ€§æ ¼ç±»å‹ï¼Œäº†è§£çœŸå®çš„è‡ªå·±<br>åŸºäºè£æ ¼å¿ƒç†å­¦ç†è®ºçš„ä¸“ä¸šæµ‹è¯•</p>
            
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">ğŸ“</div>
                    <div class="feature-text">28é“é¢˜ç›®</div>
                </div>
                <div class="feature">
                    <div class="feature-icon">â±ï¸</div>
                    <div class="feature-text">çº¦5åˆ†é’Ÿ</div>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ¯</div>
                    <div class="feature-text">16ç§äººæ ¼</div>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ’¡</div>
                    <div class="feature-text">è¯¦ç»†è§£è¯»</div>
                </div>
            </div>
            
            <button class="btn" onclick="startTest()">å¼€å§‹æµ‹è¯•</button>
        </div>

        <!-- æµ‹è¯•é¡µé¢ -->
        <div class="card test-page" id="testPage">
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <div class="progress-text" id="progressText">1 / 28</div>
            
            <div class="question" id="question"></div>
            
            <div class="options" id="options"></div>
        </div>

        <!-- åŠ è½½é¡µé¢ -->
        <div class="card loading" id="loadingPage">
            <div class="spinner"></div>
            <p>æ­£åœ¨åˆ†æä½ çš„æ€§æ ¼ç±»å‹...</p>
        </div>

        <!-- ç»“æœé¡µé¢ -->
        <div class="card result-page" id="resultPage">
            <div class="result-type" id="resultType"></div>
            <div class="result-name" id="resultName"></div>
            
            <div class="dimensions" id="dimensions"></div>
            
            <div class="result-desc" id="resultDesc"></div>
            
            <h3 style="margin-bottom: 15px; color: #333;">æ€§æ ¼ç‰¹ç‚¹</h3>
            <div class="traits" id="traits"></div>
            
            <div class="buttons">
                <button class="btn" onclick="shareResult()">åˆ†äº«ç»“æœ</button>
            </div>
        </div>

        <!-- å·²ä½¿ç”¨é¡µé¢ -->
        <div class="card completed-page" id="completedPage">
            <div class="completed-icon">âœ…</div>
            <h2 class="completed-title">è¯¥éªŒè¯ç å·²ä½¿ç”¨</h2>
            <p class="completed-text">æ­¤éªŒè¯ç å·²å®Œæˆæµ‹è¯•ï¼Œæ¯ä¸ªéªŒè¯ç åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚<br>å¦‚éœ€å†æ¬¡æµ‹è¯•ï¼Œè¯·è”ç³»ç®¡ç†å‘˜è·å–æ–°çš„éªŒè¯ç ã€‚</p>
            <button class="btn" style="margin-top: 25px;" onclick="showVerifyPage()">ä½¿ç”¨å…¶ä»–éªŒè¯ç </button>
        </div>
    </div>

    <script>
        // ========== LeanCloud é…ç½® ==========
        const LC_CONFIG = {
            appId: 'rXjTMruNu4IYflQMJGYdXQGY-gzGzoHsz',
            appKey: 'qRUw6afI4c1m5eHgpPG1fUrM',
            serverURL: 'https://rxjtmrun.lc-cn-n1-shared.com'
        };

        // å½“å‰éªŒè¯ç ä¿¡æ¯
        let currentCodeData = null;

        // ========== LeanCloud API è°ƒç”¨ ==========
        
        async function lcRequest(method, endpoint, data = null) {
            const url = `${LC_CONFIG.serverURL}/1.1${endpoint}`;
            const options = {
                method: method,
                headers: {
                    'X-LC-Id': LC_CONFIG.appId,
                    'X-LC-Key': LC_CONFIG.appKey,
                    'Content-Type': 'application/json'
                }
            };
            if (data) {
                options.body = JSON.stringify(data);
            }
            const response = await fetch(url, options);
            return response.json();
        }

        // æŸ¥è¯¢éªŒè¯ç 
        async function queryCode(code) {
            const where = encodeURIComponent(JSON.stringify({ code: code.toUpperCase() }));
            return lcRequest('GET', `/classes/VerificationCode?where=${where}`);
        }

        // æ›´æ–°éªŒè¯ç çŠ¶æ€
        async function updateCodeStatus(objectId, result) {
            return lcRequest('PUT', `/classes/VerificationCode/${objectId}`, {
                used: true,
                usedAt: { "__type": "Date", "iso": new Date().toISOString() },
                result: result
            });
        }

        // ========== éªŒè¯ç éªŒè¯ ==========
        
        async function verifyCode() {
            const input = document.getElementById('codeInput');
            const btn = document.getElementById('verifyBtn');
            const code = input.value.trim().toUpperCase();
            
            if (!code) {
                showError('è¯·è¾“å…¥éªŒè¯ç ');
                return;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            btn.disabled = true;
            btn.classList.add('loading-btn');
            
            try {
                const result = await queryCode(code);
                
                if (!result.results || result.results.length === 0) {
                    showError('éªŒè¯ç ä¸å­˜åœ¨');
                    return;
                }
                
                const codeData = result.results[0];
                
                if (codeData.used) {
                    showError('è¯¥éªŒè¯ç å·²è¢«ä½¿ç”¨');
                    hideAllPages();
                    document.getElementById('completedPage').style.display = 'block';
                    return;
                }
                
                // éªŒè¯æˆåŠŸï¼Œä¿å­˜æ•°æ®
                currentCodeData = codeData;
                showHomePage(code);
                
            } catch (error) {
                console.error('éªŒè¯å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
            } finally {
                btn.disabled = false;
                btn.classList.remove('loading-btn');
            }
        }

        function showError(message) {
            const input = document.getElementById('codeInput');
            const errorMsg = document.getElementById('errorMessage');
            errorMsg.textContent = message;
            errorMsg.classList.add('show');
            input.classList.add('error');
            input.parentElement.classList.add('shake');
            
            setTimeout(() => {
                input.parentElement.classList.remove('shake');
            }, 500);
        }

        function showVerifyPage() {
            hideAllPages();
            document.getElementById('verifyPage').style.display = 'block';
            document.getElementById('codeInput').value = '';
            document.getElementById('codeInput').classList.remove('error');
            document.getElementById('errorMessage').classList.remove('show');
        }

        function showHomePage(code) {
            hideAllPages();
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('userCodeBadge').textContent = 'éªŒè¯ç : ' + code;
        }

        function hideAllPages() {
            document.getElementById('verifyPage').style.display = 'none';
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('testPage').style.display = 'none';
            document.getElementById('loadingPage').style.display = 'none';
            document.getElementById('resultPage').style.display = 'none';
            document.getElementById('completedPage').style.display = 'none';
        }

        // ========== MBTIæµ‹è¯•é€»è¾‘ ==========

        const questions = [
            // E vs I (7é¢˜)
            { q: "åœ¨ç¤¾äº¤èšä¼šä¸­ï¼Œä½ é€šå¸¸ä¼šï¼š", a: "ä¸»åŠ¨ç»“è¯†æ–°æœ‹å‹ï¼Œäº«å—ç¤¾äº¤", b: "å€¾å‘äºå’Œç†Ÿäººå¾…åœ¨ä¸€èµ·", d: "EI" },
            { q: "å‘¨æœ«ä¼‘æ¯æ—¶ï¼Œä½ æ›´å–œæ¬¢ï¼š", a: "å’Œæœ‹å‹å¤–å‡ºæ´»åŠ¨", b: "ç‹¬è‡ªåœ¨å®¶çœ‹ä¹¦æˆ–çœ‹å‰§", d: "EI" },
            { q: "å·¥ä½œæˆ–å­¦ä¹ æ—¶ï¼Œä½ æ›´å–œæ¬¢ï¼š", a: "åœ¨çƒ­é—¹çš„ç¯å¢ƒä¸­ï¼Œæœ‰äººå¯ä»¥äº¤æµ", b: "åœ¨å®‰é™çš„ç¯å¢ƒä¸­ï¼Œç‹¬è‡ªä¸“æ³¨", d: "EI" },
            { q: "é‡åˆ°é—®é¢˜æ—¶ï¼Œä½ å€¾å‘äºï¼š", a: "æ‰¾äººè®¨è®ºï¼Œé€šè¿‡äº¤æµç†æ¸…æ€è·¯", b: "è‡ªå·±æ€è€ƒï¼Œæƒ³æ¸…æ¥šå†è¯´", d: "EI" },
            { q: "åœ¨å›¢é˜Ÿä¸­ï¼Œä½ é€šå¸¸ï¼š", a: "ç§¯æå‘è¨€ï¼Œæ¨åŠ¨è®¨è®º", b: "å€¾å¬ä¸ºä¸»ï¼Œå¿…è¦æ—¶æ‰å‘è¨€", d: "EI" },
            { q: "é•¿æ—¶é—´ç‹¬å¤„åï¼Œä½ ä¼šï¼š", a: "æ¸´æœ›å‡ºå»è§è§æœ‹å‹", b: "æ„Ÿè§‰å¾ˆå……å®ï¼Œä¸æ€¥ç€ç¤¾äº¤", d: "EI" },
            { q: "ä½ çš„æœ‹å‹åœˆé€šå¸¸æ˜¯ï¼š", a: "å¹¿æ³›ï¼Œè®¤è¯†å¾ˆå¤šäºº", b: "è¾ƒå°ï¼Œä½†å…³ç³»æ·±åš", d: "EI" },
            
            // S vs N (7é¢˜)
            { q: "å­¦ä¹ æ–°äº‹ç‰©æ—¶ï¼Œä½ æ›´å–œæ¬¢ï¼š", a: "å…·ä½“çš„ä¾‹å­å’Œå®é™…æ“ä½œ", b: "ç†è®ºæ¡†æ¶å’Œæ¦‚å¿µç†è§£", d: "SN" },
            { q: "ä½ æ›´å…³æ³¨ï¼š", a: "å½“ä¸‹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…", b: "æœªæ¥çš„å¯èƒ½æ€§å’Œè¶‹åŠ¿", d: "SN" },
            { q: "æè¿°ä¸€ä»¶äº‹æ—¶ï¼Œä½ å€¾å‘äºï¼š", a: "è¯¦ç»†æè¿°å…·ä½“ç»†èŠ‚", b: "æ¦‚æ‹¬æ€§åœ°è¯´æ˜è¦ç‚¹", d: "SN" },
            { q: "ä½ æ›´ä¿¡ä»»ï¼š", a: "äº²èº«ç»å†å’Œå®é™…ç»éªŒ", b: "ç›´è§‰å’Œç¬¬å…­æ„Ÿ", d: "SN" },
            { q: "é˜…è¯»æ—¶ï¼Œä½ æ›´å–œæ¬¢ï¼š", a: "å®ç”¨æ€§çš„å†…å®¹ï¼Œå¦‚æ•™ç¨‹ã€æ”»ç•¥", b: "å¯Œæœ‰æƒ³è±¡åŠ›çš„å†…å®¹ï¼Œå¦‚ç§‘å¹»ã€å“²å­¦", d: "SN" },
            { q: "åšè®¡åˆ’æ—¶ï¼Œä½ æ›´æ³¨é‡ï¼š", a: "å¯è¡Œæ€§å’Œå…·ä½“æ­¥éª¤", b: "åˆ›æ–°æ€§å’Œé•¿è¿œç›®æ ‡", d: "SN" },
            { q: "ä½ è®¤ä¸ºè‡ªå·±æ˜¯ï¼š", a: "åŠ¡å®çš„ç°å®ä¸»ä¹‰è€…", b: "å¯Œæœ‰æƒ³è±¡åŠ›çš„ç†æƒ³ä¸»ä¹‰è€…", d: "SN" },
            
            // T vs F (7é¢˜)
            { q: "åšå†³å®šæ—¶ï¼Œä½ æ›´ä¾èµ–ï¼š", a: "é€»è¾‘åˆ†æå’Œå®¢è§‚äº‹å®", b: "ä¸ªäººä»·å€¼è§‚å’Œå¯¹ä»–äººçš„å½±å“", d: "TF" },
            { q: "ä¸äººå‘ç”Ÿåˆ†æ­§æ—¶ï¼Œä½ æ›´åœ¨æ„ï¼š", a: "è°çš„è§‚ç‚¹æ›´æ­£ç¡®åˆç†", b: "ç»´æŠ¤å…³ç³»å’Œå¯¹æ–¹çš„æ„Ÿå—", d: "TF" },
            { q: "ç»™æœ‹å‹å»ºè®®æ—¶ï¼Œä½ å€¾å‘äºï¼š", a: "ç›´æ¥æŒ‡å‡ºé—®é¢˜ï¼Œæä¾›è§£å†³æ–¹æ¡ˆ", b: "å…ˆè¡¨ç¤ºç†è§£ï¼Œå†å§”å©‰å»ºè®®", d: "TF" },
            { q: "ä½ è®¤ä¸ºå¥½çš„å†³ç­–åº”è¯¥ï¼š", a: "åŸºäºäº‹å®å’Œæ•°æ®ï¼Œå…¬æ­£å®¢è§‚", b: "è€ƒè™‘äººæƒ…å’Œå…·ä½“æƒ…å†µï¼Œçµæ´»å¤„ç†", d: "TF" },
            { q: "åˆ«äººå¤¸å¥–ä½ æ—¶ï¼Œä½ æ›´å¸Œæœ›è¢«è¯´ï¼š", a: "èªæ˜ã€èƒ½å¹²ã€æœ‰èƒ½åŠ›", b: "å–„è‰¯ã€ä½“è´´ã€æœ‰çˆ±å¿ƒ", d: "TF" },
            { q: "åœ¨è®¨è®ºä¸­ï¼Œä½ æ›´çœ‹é‡ï¼š", a: "è®ºç‚¹æ˜¯å¦æœ‰ç†æœ‰æ®", b: "è®¨è®ºæ°›å›´æ˜¯å¦å’Œè°", d: "TF" },
            { q: "é¢å¯¹ä»–äººçš„é”™è¯¯ï¼Œä½ ä¼šï¼š", a: "ç›´æ¥æŒ‡å‡ºï¼Œå¸®åŠ©æ”¹æ­£", b: "è€ƒè™‘å¯¹æ–¹æ„Ÿå—ï¼Œæ‰¾åˆé€‚æ—¶æœºè¯´", d: "TF" },
            
            // J vs P (7é¢˜)
            { q: "ä½ æ›´å–œæ¬¢çš„ç”Ÿæ´»æ–¹å¼æ˜¯ï¼š", a: "æœ‰è®¡åˆ’ã€æœ‰æ¡ç†çš„ç”Ÿæ´»", b: "éšæ€§ã€çµæ´»çš„ç”Ÿæ´»", d: "JP" },
            { q: "é¢å¯¹deadlineï¼Œä½ é€šå¸¸ï¼š", a: "æå‰å®Œæˆï¼Œç•™æœ‰ä½™åœ°", b: "ä¸´è¿‘æˆªæ­¢æ—¶æ•ˆç‡æ›´é«˜", d: "JP" },
            { q: "æ—…è¡Œæ—¶ï¼Œä½ æ›´å–œæ¬¢ï¼š", a: "æå‰è§„åˆ’å¥½è¡Œç¨‹", b: "èµ°åˆ°å“ªç®—å“ªï¼Œéšæœºæ¢ç´¢", d: "JP" },
            { q: "ä½ çš„å·¥ä½œ/å­¦ä¹ ç©ºé—´é€šå¸¸ï¼š", a: "æ•´æ´æœ‰åºï¼Œç‰©å“å½’ä½", b: "çœ‹ä¼¼å‡Œä¹±ä½†è‡ªå·±èƒ½æ‰¾åˆ°ä¸œè¥¿", d: "JP" },
            { q: "åšå†³å®šæ—¶ï¼Œä½ å€¾å‘äºï¼š", a: "å¿«é€Ÿå†³å®šï¼Œç¡®å®šåå°±æ‰§è¡Œ", b: "ä¿æŒå¼€æ”¾ï¼Œæ”¶é›†æ›´å¤šä¿¡æ¯å†è¯´", d: "JP" },
            { q: "ä½ å¯¹è§„åˆ™å’Œæµç¨‹çš„æ€åº¦æ˜¯ï¼š", a: "è®¤ä¸ºè§„åˆ™èƒ½æé«˜æ•ˆç‡", b: "è®¤ä¸ºè§„åˆ™æœ‰æ—¶ä¼šé™åˆ¶åˆ›é€ åŠ›", d: "JP" },
            { q: "å½“è®¡åˆ’è¢«æ‰“ä¹±æ—¶ï¼Œä½ ä¼šï¼š", a: "æ„Ÿåˆ°ä¸å®‰ï¼Œæƒ³å°½å¿«å›åˆ°æ­£è½¨", b: "è§‰å¾—æ²¡å…³ç³»ï¼Œé¡ºå…¶è‡ªç„¶", d: "JP" }
        ];

        const personalities = {
            "INTJ": { name: "å»ºç­‘å¸ˆ", desc: "INTJæ˜¯å…·æœ‰æˆ˜ç•¥æ€ç»´çš„ç‹¬ç«‹æ€è€ƒè€…ã€‚ä»–ä»¬å–„äºåˆ¶å®šé•¿æœŸè®¡åˆ’ï¼Œå¯¹çŸ¥è¯†æœ‰å¼ºçƒˆæ¸´æœ›ï¼Œè¿½æ±‚å®Œç¾å’Œæ•ˆç‡ã€‚ä»–ä»¬å¾€å¾€æœ‰ç‹¬ç‰¹çš„è§è§£ï¼Œä¸éšæ³¢é€æµï¼Œåœ¨è‡ªå·±æ„Ÿå…´è¶£çš„é¢†åŸŸä¼šæŠ•å…¥å¤§é‡ç²¾åŠ›é’»ç ”ã€‚", traits: ["æˆ˜ç•¥æ€ç»´", "ç‹¬ç«‹è‡ªä¸»", "è¿½æ±‚å®Œç¾", "ç†æ€§åˆ†æ", "ç›®æ ‡å¯¼å‘"] },
            "INTP": { name: "é€»è¾‘å­¦å®¶", desc: "INTPæ˜¯å¯Œæœ‰åˆ›é€ åŠ›çš„åˆ†æè€…ï¼Œå–œæ¬¢æ¢ç´¢ç†è®ºå’ŒæŠ½è±¡æ¦‚å¿µã€‚ä»–ä»¬å¯¹çŸ¥è¯†æœ‰æ— å°½çš„å¥½å¥‡å¿ƒï¼Œäº«å—è§£å†³å¤æ‚é—®é¢˜çš„è¿‡ç¨‹ã€‚è™½ç„¶åœ¨ç¤¾äº¤ä¸Šå¯èƒ½æ˜¾å¾—å†…æ•›ï¼Œä½†åœ¨æ„Ÿå…´è¶£çš„è¯é¢˜ä¸Šä¼šéå¸¸å¥è°ˆã€‚", traits: ["é€»è¾‘æ€ç»´", "å¥½å¥‡å¿ƒå¼º", "åˆ›æ–°æ€ç»´", "å®¢è§‚ç†æ€§", "ç‹¬ç«‹æ€è€ƒ"] },
            "ENTJ": { name: "æŒ‡æŒ¥å®˜", desc: "ENTJæ˜¯å¤©ç”Ÿçš„é¢†å¯¼è€…ï¼Œæœ‰å¼ºçƒˆçš„é©±åŠ¨åŠ›å’Œç»„ç»‡èƒ½åŠ›ã€‚ä»–ä»¬å–„äºåˆ¶å®šæˆ˜ç•¥ç›®æ ‡å¹¶å¸¦é¢†å›¢é˜Ÿå®ç°ï¼Œåšäº‹æœæ–­é«˜æ•ˆï¼Œè¿½æ±‚å“è¶Šã€‚ä»–ä»¬äº«å—æŒ‘æˆ˜ï¼Œä¸ç•å›°éš¾ï¼Œæ€»æ˜¯å……æ»¡è‡ªä¿¡ã€‚", traits: ["é¢†å¯¼åŠ›å¼º", "æœæ–­é«˜æ•ˆ", "æˆ˜ç•¥çœ¼å…‰", "è‡ªä¿¡æœæ•¢", "è¿½æ±‚å“è¶Š"] },
            "ENTP": { name: "è¾©è®ºå®¶", desc: "ENTPæ˜¯æœºæ™ºçµæ´»çš„æ€æƒ³å®¶ï¼Œå–œæ¬¢æ™ºåŠ›ä¸Šçš„æŒ‘æˆ˜å’Œè¾©è®ºã€‚ä»–ä»¬æ€ç»´æ•æ·ï¼Œå–„äºä»ä¸åŒè§’åº¦çœ‹é—®é¢˜ï¼Œä¸å–œæ¬¢å¢¨å®ˆæˆè§„ã€‚ä»–ä»¬å……æ»¡åˆ›æ„ï¼Œå–œæ¬¢æ¢ç´¢æ–°çš„å¯èƒ½æ€§ã€‚", traits: ["æ€ç»´æ•æ·", "å–„äºè¾©è®º", "åˆ›æ„ä¸°å¯Œ", "é€‚åº”åŠ›å¼º", "æŒ‘æˆ˜ä¼ ç»Ÿ"] },
            "INFJ": { name: "æå€¡è€…", desc: "INFJæ˜¯å¯Œæœ‰æ´å¯ŸåŠ›çš„ç†æƒ³ä¸»ä¹‰è€…ï¼Œå¯¹äººæ€§æœ‰æ·±åˆ»ç†è§£ã€‚ä»–ä»¬è¿½æ±‚æœ‰æ„ä¹‰çš„äººç”Ÿï¼Œå¸Œæœ›èƒ½å¯¹ä¸–ç•Œäº§ç”Ÿç§¯æå½±å“ã€‚è™½ç„¶æ€§æ ¼å†…æ•›ï¼Œä½†å†…å¿ƒä¸–ç•Œä¸°å¯Œï¼Œå¯¹ä»–äººæœ‰å¼ºçƒˆçš„åŒç†å¿ƒã€‚", traits: ["æ´å¯ŸåŠ›å¼º", "å¯Œæœ‰åŒç†å¿ƒ", "ç†æƒ³ä¸»ä¹‰", "è¿½æ±‚æ„ä¹‰", "å†…å¿ƒä¸°å¯Œ"] },
            "INFP": { name: "è°ƒåœè€…", desc: "INFPæ˜¯å¯Œæœ‰æƒ³è±¡åŠ›çš„ç†æƒ³ä¸»ä¹‰è€…ï¼Œè¿½æ±‚å†…å¿ƒçš„å’Œè°ä¸çœŸå®ã€‚ä»–ä»¬é‡è§†ä¸ªäººä»·å€¼è§‚ï¼Œæœ‰ä¸°å¯Œçš„å†…å¿ƒä¸–ç•Œå’Œåˆ›é€ åŠ›ã€‚å¯¹ç¾å’Œæƒ…æ„Ÿæœ‰æ•é”çš„æ„ŸçŸ¥ï¼Œå¸¸å¸¸é€šè¿‡è‰ºæœ¯æˆ–å†™ä½œè¡¨è¾¾è‡ªå·±ã€‚", traits: ["æƒ³è±¡åŠ›ä¸°å¯Œ", "è¿½æ±‚çœŸå®", "å¯Œæœ‰åˆ›é€ åŠ›", "é‡è§†ä»·å€¼", "æ„Ÿæ€§ç»†è…»"] },
            "ENFJ": { name: "ä¸»äººå…¬", desc: "ENFJæ˜¯å¯Œæœ‰é­…åŠ›çš„é¢†å¯¼è€…ï¼Œå¤©ç”Ÿå–„äºç†è§£å’Œæ¿€åŠ±ä»–äººã€‚ä»–ä»¬å…³å¿ƒä»–äººçš„æˆé•¿å’Œå¹¸ç¦ï¼Œä¹äºå¸®åŠ©åˆ«äººå®ç°æ½œèƒ½ã€‚ä»–ä»¬æœ‰å¾ˆå¼ºçš„ç¤¾äº¤èƒ½åŠ›ï¼Œèƒ½å¤Ÿå‡èšå›¢é˜Ÿå‘å…±åŒç›®æ ‡åŠªåŠ›ã€‚", traits: ["å–„äºæ¿€åŠ±", "å¯Œæœ‰é­…åŠ›", "å…³å¿ƒä»–äºº", "é¢†å¯¼åŠ›å¼º", "çƒ­æƒ…æ´‹æº¢"] },
            "ENFP": { name: "ç«é€‰è€…", desc: "ENFPæ˜¯çƒ­æƒ…æ´‹æº¢çš„åˆ›æ„è€…ï¼Œå¯¹ç”Ÿæ´»å……æ»¡å¥½å¥‡å’Œçƒ­æƒ…ã€‚ä»–ä»¬å–œæ¬¢æ¢ç´¢æ–°çš„å¯èƒ½æ€§ï¼Œå–„äºå‘ç°ä»–äººçš„æ½œåŠ›ã€‚ä»–ä»¬ä¹è§‚å¼€æœ—ï¼Œå¯Œæœ‰æ„ŸæŸ“åŠ›ï¼Œèƒ½å¤Ÿæ¿€å‘å‘¨å›´äººçš„çƒ­æƒ…ã€‚", traits: ["çƒ­æƒ…æ´‹æº¢", "åˆ›æ„ä¸°å¯Œ", "ä¹è§‚å¼€æœ—", "å–„äºäº¤é™…", "è¿½æ±‚è‡ªç”±"] },
            "ISTJ": { name: "ç‰©æµå¸ˆ", desc: "ISTJæ˜¯å¯é è´Ÿè´£çš„å®å¹²å®¶ï¼Œé‡è§†ä¼ ç»Ÿå’Œç§©åºã€‚ä»–ä»¬åšäº‹è®¤çœŸç»†è‡´ï¼Œæœ‰å¼ºçƒˆçš„è´£ä»»æ„Ÿå’ŒèŒä¸šé“å¾·ã€‚ä»–ä»¬è„šè¸å®åœ°ï¼Œè¨€å‡ºå¿…è¡Œï¼Œæ˜¯å€¼å¾—ä¿¡èµ–çš„ä¼™ä¼´ã€‚", traits: ["å¯é è´Ÿè´£", "è®¤çœŸç»†è‡´", "é‡è§†ä¼ ç»Ÿ", "è„šè¸å®åœ°", "è¨€å‡ºå¿…è¡Œ"] },
            "ISFJ": { name: "å®ˆå«è€…", desc: "ISFJæ˜¯æ¸©æš–ä½“è´´çš„å®ˆæŠ¤è€…ï¼Œé»˜é»˜å…³å¿ƒå’Œç…§é¡¾èº«è¾¹çš„äººã€‚ä»–ä»¬æœ‰å¼ºçƒˆçš„è´£ä»»æ„Ÿï¼Œåšäº‹ç»†å¿ƒå‘¨åˆ°ã€‚ä»–ä»¬é‡è§†å’Œè°ç¨³å®šï¼Œæ„¿æ„ä¸ºä»–äººä»˜å‡ºï¼Œæ˜¯å¯é çš„æ”¯æŒè€…ã€‚", traits: ["æ¸©æš–ä½“è´´", "ç»†å¿ƒå‘¨åˆ°", "è´£ä»»å¿ƒå¼º", "é»˜é»˜ä»˜å‡º", "é‡è§†å’Œè°"] },
            "ESTJ": { name: "æ€»ç»ç†", desc: "ESTJæ˜¯é«˜æ•ˆåŠ¡å®çš„ç»„ç»‡è€…ï¼Œå–„äºç®¡ç†å’Œæ‰§è¡Œã€‚ä»–ä»¬é‡è§†ç§©åºå’Œè§„åˆ™ï¼Œåšäº‹æœ‰æ¡ç†ï¼Œè¿½æ±‚æ•ˆç‡ã€‚ä»–ä»¬ç›´æ¥å¦ç‡ï¼Œæœ‰å¾ˆå¼ºçš„æ‰§è¡ŒåŠ›ï¼Œæ˜¯å¯é çš„ç®¡ç†è€…ã€‚", traits: ["é«˜æ•ˆåŠ¡å®", "ç»„ç»‡èƒ½åŠ›å¼º", "é‡è§†ç§©åº", "ç›´æ¥å¦ç‡", "æ‰§è¡ŒåŠ›å¼º"] },
            "ESFJ": { name: "æ‰§æ”¿å®˜", desc: "ESFJæ˜¯çƒ­å¿ƒåŠ©äººçš„ç¤¾äº¤è€…ï¼Œå–„äºç…§é¡¾ä»–äººçš„éœ€æ±‚ã€‚ä»–ä»¬é‡è§†å’Œè°çš„äººé™…å…³ç³»ï¼Œä¹äºä¸ºä»–äººæœåŠ¡ã€‚ä»–ä»¬çƒ­æƒ…å‹å¥½ï¼Œæ˜¯å›¢é˜Ÿä¸­çš„ç²˜åˆå‰‚ï¼Œèƒ½å¤Ÿè¥é€ æ¸©é¦¨çš„æ°›å›´ã€‚", traits: ["çƒ­å¿ƒåŠ©äºº", "å–„äºç¤¾äº¤", "é‡è§†å’Œè°", "ä½“è´´å‘¨åˆ°", "ä¹äºæœåŠ¡"] },
            "ISTP": { name: "é‰´èµå®¶", desc: "ISTPæ˜¯å†·é™çµæ´»çš„å®è·µè€…ï¼Œå–„äºåˆ†æå’Œè§£å†³å®é™…é—®é¢˜ã€‚ä»–ä»¬å–œæ¬¢åŠ¨æ‰‹æ“ä½œï¼Œå¯¹æœºæ¢°å’Œå·¥å…·æœ‰å¤©ç”Ÿçš„å…´è¶£ã€‚ä»–ä»¬ç‹¬ç«‹è‡ªä¸»ï¼Œåšäº‹è®²ç©¶æ•ˆç‡ï¼Œåœ¨å±æœºæ—¶åˆ»èƒ½ä¿æŒå†·é™ã€‚", traits: ["å†·é™ç†æ€§", "åŠ¨æ‰‹èƒ½åŠ›å¼º", "ç‹¬ç«‹è‡ªä¸»", "çµæ´»åŠ¡å®", "å–„äºåˆ†æ"] },
            "ISFP": { name: "æ¢é™©å®¶", desc: "ISFPæ˜¯æ¸©å’Œæ•æ„Ÿçš„è‰ºæœ¯å®¶ï¼Œæœ‰ç‹¬ç‰¹çš„å®¡ç¾å’Œä»·å€¼è§‚ã€‚ä»–ä»¬äº«å—å½“ä¸‹ï¼Œå¯¹ç¾æœ‰æ•é”çš„æ„ŸçŸ¥ã€‚ä»–ä»¬ä¸å–œæ¬¢å†²çªï¼Œè¿½æ±‚å†…å¿ƒçš„å’Œè°ï¼Œç”¨è¡ŒåŠ¨è€Œéè¨€è¯­è¡¨è¾¾å…³çˆ±ã€‚", traits: ["æ¸©å’Œæ•æ„Ÿ", "å®¡ç¾ç‹¬ç‰¹", "äº«å—å½“ä¸‹", "è¿½æ±‚å’Œè°", "è‰ºæœ¯å¤©èµ‹"] },
            "ESTP": { name: "ä¼ä¸šå®¶", desc: "ESTPæ˜¯ç²¾åŠ›å……æ²›çš„è¡ŒåŠ¨æ´¾ï¼Œå–œæ¬¢å†’é™©å’Œåˆºæ¿€ã€‚ä»–ä»¬å–„äºæŠŠæ¡æœºä¼šï¼Œåšäº‹æœæ–­è¿…é€Ÿã€‚ä»–ä»¬åŠ¡å®çµæ´»ï¼Œå–„äºåº”å¯¹çªå‘çŠ¶å†µï¼Œæ˜¯å¤©ç”Ÿçš„é—®é¢˜è§£å†³è€…ã€‚", traits: ["ç²¾åŠ›å……æ²›", "è¡ŒåŠ¨è¿…é€Ÿ", "å–„äºå†’é™©", "åŠ¡å®çµæ´»", "æŠŠæ¡æœºä¼š"] },
            "ESFP": { name: "è¡¨æ¼”è€…", desc: "ESFPæ˜¯çƒ­æƒ…æ´»æ³¼çš„å¨±ä¹è€…ï¼Œå–œæ¬¢æˆä¸ºä¼—äººç„¦ç‚¹ã€‚ä»–ä»¬äº«å—ç”Ÿæ´»ï¼Œå–„äºè¥é€ æ¬¢ä¹æ°›å›´ã€‚ä»–ä»¬å¾…äººå‹å–„ï¼Œä¹è§‚å¼€æœ—ï¼Œèƒ½å¤Ÿæ„ŸæŸ“å‘¨å›´çš„äººï¼Œè®©å¤§å®¶æ„Ÿåˆ°å¿«ä¹ã€‚", traits: ["çƒ­æƒ…æ´»æ³¼", "ä¹è§‚å¼€æœ—", "å–„äºå¨±ä¹", "å¾…äººå‹å–„", "äº«å—ç”Ÿæ´»"] }
        };

        let currentQuestion = 0;
        let scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };

        function startTest() {
            hideAllPages();
            document.getElementById('testPage').style.display = 'block';
            currentQuestion = 0;
            scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('question').textContent = q.q;
            document.getElementById('progressText').textContent = `${currentQuestion + 1} / ${questions.length}`;
            document.getElementById('progress').style.width = `${((currentQuestion + 1) / questions.length) * 100}%`;
            
            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = `
                <div class="option" onclick="selectOption('a')">A. ${q.a}</div>
                <div class="option" onclick="selectOption('b')">B. ${q.b}</div>
            `;
        }

        function selectOption(choice) {
            const q = questions[currentQuestion];
            const dimension = q.d;
            
            if (choice === 'a') {
                scores[dimension[0]]++;
            } else {
                scores[dimension[1]]++;
            }
            
            currentQuestion++;
            
            if (currentQuestion < questions.length) {
                const testPage = document.getElementById('testPage');
                testPage.style.animation = 'none';
                setTimeout(() => {
                    testPage.style.animation = 'slideUp 0.3s ease';
                    showQuestion();
                }, 50);
            } else {
                showLoading();
            }
        }

        function showLoading() {
            hideAllPages();
            document.getElementById('loadingPage').style.display = 'block';
            
            setTimeout(() => {
                calculateAndShowResult();
            }, 2000);
        }

        async function calculateAndShowResult() {
            const type = (scores.E >= scores.I ? 'E' : 'I') +
                        (scores.S >= scores.N ? 'S' : 'N') +
                        (scores.T >= scores.F ? 'T' : 'F') +
                        (scores.J >= scores.P ? 'J' : 'P');
            
            // ä¿å­˜ç»“æœåˆ°æœåŠ¡å™¨
            if (currentCodeData) {
                const resultData = {
                    type: type,
                    scores: scores,
                    completedAt: new Date().toISOString()
                };
                
                try {
                    await updateCodeStatus(currentCodeData.objectId, resultData);
                } catch (error) {
                    console.error('ä¿å­˜ç»“æœå¤±è´¥:', error);
                }
            }
            
            hideAllPages();
            document.getElementById('resultPage').style.display = 'block';
            displayResult(type, scores);
        }

        function displayResult(type, scores) {
            const personality = personalities[type];
            
            document.getElementById('resultType').textContent = type;
            document.getElementById('resultName').textContent = personality.name;
            document.getElementById('resultDesc').textContent = personality.desc;
            
            const dimensionsDiv = document.getElementById('dimensions');
            const dims = [
                { left: 'E å¤–å‘', right: 'å†…å‘ I', leftScore: scores.E, rightScore: scores.I },
                { left: 'S æ„Ÿè§‰', right: 'ç›´è§‰ N', leftScore: scores.S, rightScore: scores.N },
                { left: 'T æ€è€ƒ', right: 'æƒ…æ„Ÿ F', leftScore: scores.T, rightScore: scores.F },
                { left: 'J åˆ¤æ–­', right: 'æ„ŸçŸ¥ P', leftScore: scores.J, rightScore: scores.P }
            ];
            
            dimensionsDiv.innerHTML = dims.map(d => {
                const total = d.leftScore + d.rightScore;
                const leftPercent = Math.round((d.leftScore / total) * 100);
                return `
                    <div class="dimension">
                        <div class="dimension-label">
                            <span class="dimension-left">${d.left} ${leftPercent}%</span>
                            <span class="dimension-right">${100 - leftPercent}% ${d.right}</span>
                        </div>
                        <div class="dimension-bar">
                            <div class="dimension-fill" style="width: ${leftPercent}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
            
            const traitsDiv = document.getElementById('traits');
            traitsDiv.innerHTML = personality.traits.map(t => `<span class="trait">${t}</span>`).join('');
        }

        function shareResult() {
            const type = document.getElementById('resultType').textContent;
            const name = document.getElementById('resultName').textContent;
            const text = `æˆ‘çš„MBTIæ€§æ ¼ç±»å‹æ˜¯ ${type}ï¼ˆ${name}ï¼‰ï¼å¿«æ¥æµ‹æµ‹ä½ æ˜¯ä»€ä¹ˆç±»å‹å§ï½`;
            
            if (navigator.share) {
                navigator.share({ title: 'MBTIæ€§æ ¼æµ‹è¯•ç»“æœ', text: text });
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    alert('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            }
        }

        // é¡µé¢åŠ è½½
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('codeInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    verifyCode();
                }
            });
            
            document.getElementById('codeInput').addEventListener('input', function() {
                this.classList.remove('error');
                document.getElementById('errorMessage').classList.remove('show');
            });
        });
    </script>
</body>
</html>
